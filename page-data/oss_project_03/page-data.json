{"componentChunkName":"component---src-templates-post-jsx","path":"/oss_project_03/","result":{"data":{"site":{"siteMetadata":{"title":"Changmin"}},"markdownRemark":{"id":"243c95d7-52e9-511c-bc84-153b14dd56b2","excerpt":"[NestJS] @nestjs/microservices should handle RabbitMQ bindings and auto-generated queues 진행 이슈 link PR link 이슈 내용 nestjs 에서 제공하는 microservices 에서 RabbitMQ 를 사용할 경우, RMQ의 binding 과 auto-generated queu…","html":"<h3 id=\"NestJS-nestjsmicroservices-should-handle-RabbitMQ-bindings-and-auto-generated-queues\" style=\"position:relative;\"><a href=\"#NestJS-nestjsmicroservices-should-handle-RabbitMQ-bindings-and-auto-generated-queues\" aria-label=\"NestJS nestjsmicroservices should handle RabbitMQ bindings and auto generated queues permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>[NestJS] @nestjs/microservices should handle RabbitMQ bindings and auto-generated queues</h3>\n<ul>\n<li><a href=\"https://github.com/nestjs/nest/issues/13931\">진행 이슈 link</a></li>\n<li><a href=\"https://github.com/nestjs/nest/pull/14129\">PR link</a></li>\n</ul>\n<h2 id=\"이슈-내용\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EC%8A%88-%EB%82%B4%EC%9A%A9\" aria-label=\"이슈 내용 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>이슈 내용</h2>\n<p>nestjs 에서 제공하는 microservices 에서 RabbitMQ 를 사용할 경우, RMQ의 binding 과 auto-generated queues 가 동작하지 않는 이슈</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/cd4ce777d653059301717e953592d660/134d7/image.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 112.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC6klEQVR42oVU2XLaQBDkJZXEwQYkdB/oPpAEWNiW7YorKT/k//9oMj06EoghD12zu1r19M41+/X+k+ywoCBryNrkjIxMPyXF3NBS9xneBJyt7fAKIpqtNIs2aUXVoaO0uqfqvqNi90Dp9iD77f6RSkZ1/0SbZEtzxaRb1foXSm9nNwudVNMnPy7lh4DJg7S3OL/jS0vNEdwy2de7Nc1XxkXMvi11coKMMlZTsrKiOQq2hyeKi52cJ+VeFOd1K2sQ4z8QwAI4E8KbhSbqmvZZnlezxRpPB0HNtmJyrPG9aTsq2SEc4awY1hCF14hC1dqQn1Qcy1pskNXkRiV5jCjfyT7MG/LiLTmcQDvImSAnmxM47jVOyNoKaQaZi7XLT3ymh9d32j++ia3bV4qKA/kpiCpZO2EpmRyhWr1VzJBJC6mSnlBzWcVOiNLqyCprVtsIgcpeAcUM5GfNiS9CMfyeEDVm889t94Nj9yLezgn0K0Q9EqnTSSEIobDcd1Lkupv8h+ACIZICNcm2pax+EOtGWzK8VC71uE6mu7HcV5lHFK50VzJleIlYlT2tuO0UYyNQx5azAsnkCG1oOZXPcW/JLxWFIES9ASjgaqg91B1ssTuSG+ZcRoVYJ8yk7oCQS0p3wqmDJsKsbiegh9G/KFisY+4OIWICNAGIAezHFh07RzoFh1CHqkf7YY8WQ/9+ulmK97HF/sZ8pU9EJ72s2YGoGdvI3qRkerFYJ8zl+7WBcEI4JgWxQPxkEAx9ijXig+8fKfyj9EwhlCABUAiSkQw2YkclJwVrJAhqMQQWa3vCOGkmQgQVl9vuTSaNZHyYOs3xlZLqkWdlKbFFcpCY0WI4r3m4gAzEQmi4kQxXXMDTz39weDggppafyPM/zxX6cqtOQNL6xGl9lkGyO77Ik6XukO0hBAhF232Xc9zB0EWIADi1h3qEc8RbFMIzSFEmY1yurRXDE6UKMKxVtgv+NmTZO8nY+Xj/aH8p278Bc7Fs/L7Z1AQAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='이슈 내용' title='' src='/static/cd4ce777d653059301717e953592d660/ca1dc/image.png' srcset='/static/cd4ce777d653059301717e953592d660/e7570/image.png 170w,\n/static/cd4ce777d653059301717e953592d660/f46e7/image.png 340w,\n/static/cd4ce777d653059301717e953592d660/ca1dc/image.png 680w,\n/static/cd4ce777d653059301717e953592d660/02d09/image.png 1020w,\n/static/cd4ce777d653059301717e953592d660/9d567/image.png 1360w,\n/static/cd4ce777d653059301717e953592d660/134d7/image.png 1628w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>이슈 내용</figcaption>\n  </figure></p>\n<h2 id=\"해결-과정\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EA%B3%BC%EC%A0%95\" aria-label=\"해결 과정 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>해결 과정</h2>\n<p>우선 제안한 해결 방안에 대한 가이드는 두 개로 다음과 같았습니다.</p>\n<ol>\n<li>The queues should be named in the expected format</li>\n</ol>\n<p>=> queue들은 예상된 형태로 이름이 부여되어야 함</p>\n<h3 id=\"디버깅-포인트-1\" style=\"position:relative;\"><a href=\"#%EB%94%94%EB%B2%84%EA%B9%85-%ED%8F%AC%EC%9D%B8%ED%8A%B8-1\" aria-label=\"디버깅 포인트 1 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>디버깅 포인트 1</h3>\n<blockquote>\n<p>queue의 이름이 ''로 지정될 때, RabbitMQ 의 옵션처럼 'amq.gen-asdnfks...' 형태가 아닌 'default'로 부여되는지를 파악</p>\n</blockquote>\n<p>우선 packages/microservices/constants.ts 에서 RQM_DEFAULT_QUEUE이 default로 지정되어 있었습니다. 그리고 queue 옵션이 ''로 넘어오면, queue에 RQM_DEFAULT_QUEUE이 할당되어 실제 queue name은 default로 할당되는 문제가 발생했습니다.</p>\n<p>단순히, packages/microservices/constants.ts 의 <code>export const RQM_DEFAULT_QUEUE = 'default';</code> 를 <code>export const RQM_DEFAULT_QUEUE = '';</code> 로 수정하니, 문제가 해결되었습니다.</p>\n<ol start=\"2\">\n<li>The binding should automatically happen</li>\n</ol>\n<p>=> binding은 자동적으로 진행되어야 함</p>\n<h3 id=\"디버깅-포인트-2\" style=\"position:relative;\"><a href=\"#%EB%94%94%EB%B2%84%EA%B9%85-%ED%8F%AC%EC%9D%B8%ED%8A%B8-2\" aria-label=\"디버깅 포인트 2 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>디버깅 포인트 2</h3>\n<blockquote>\n<p>binding 에 관련된 option들을 파악</p>\n</blockquote>\n<p>우선 binding 옵션은 exchange와 routingKey 인데, 실제 NestJS microservices의 rabbitMQ option에는 해당 값들이 존재하지 않았습니다. 그래서, RMQOption interface에 해당 값들을 optional로 추가해주었습니다.</p>\n<p>AS-IS</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"> isGlobalPrefetchCount<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n    queueOptions<span class=\"token operator\">?</span><span class=\"token operator\">:</span> AmqplibQueueOptions<span class=\"token punctuation\">;</span>\n    socketOptions<span class=\"token operator\">?</span><span class=\"token operator\">:</span> AmqpConnectionManagerSocketOptions<span class=\"token punctuation\">;</span>\n    noAck<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n    consumerTag<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n    serializer<span class=\"token operator\">?</span><span class=\"token operator\">:</span> Serializer<span class=\"token punctuation\">;</span></code></pre></div>\n<p>TO-BE</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"> isGlobalPrefetchCount<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n    queueOptions<span class=\"token operator\">?</span><span class=\"token operator\">:</span> AmqplibQueueOptions<span class=\"token punctuation\">;</span>\n    socketOptions<span class=\"token operator\">?</span><span class=\"token operator\">:</span> AmqpConnectionManagerSocketOptions<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// 해당 binding option을 optional로 추가</span>\n    exchange<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n    routingKey<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n    noAck<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span><span class=\"token punctuation\">;</span>\n    consumerTag<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n    serializer<span class=\"token operator\">?</span><span class=\"token operator\">:</span> Serializer<span class=\"token punctuation\">;</span></code></pre></div>\n<p>그 다음, 사용자가 지정한 binding option이 실제로 server에 적용되는 조건문이 존재하지 않았습니다. 그래서, client-rmq.ts 와 server-rmq.ts 에 해당 설정을 binding 해주는 로직을 추가했습니다.</p>\n<p>client-rmq.ts</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>noAssert<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> channel<span class=\"token punctuation\">.</span><span class=\"token function\">assertQueue</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>queue<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>queueOptions<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 기존에 존재하지 않았던 로직</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>exchange <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>routingKey<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">await</span> channel<span class=\"token punctuation\">.</span><span class=\"token function\">bindQueue</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>queue<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>exchange<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>routingKey\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">await</span> channel<span class=\"token punctuation\">.</span><span class=\"token function\">prefetch</span><span class=\"token punctuation\">(</span>prefetchCount<span class=\"token punctuation\">,</span> isGlobalPrefetchCount<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">await</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">consumeChannel</span><span class=\"token punctuation\">(</span>channel<span class=\"token punctuation\">)</span>\n<span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>server-rmq.ts</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>noAssert<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">await</span> channel<span class=\"token punctuation\">.</span><span class=\"token function\">assertQueue</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>queue<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>queueOptions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 기존에 존재하지 않았던 로직</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>exchange <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>routingKey<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">await</span> channel<span class=\"token punctuation\">.</span><span class=\"token function\">assertExchange</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>exchange<span class=\"token punctuation\">,</span> <span class=\"token string\">'topic'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    durable<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">await</span> channel<span class=\"token punctuation\">.</span><span class=\"token function\">bindQueue</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>queue<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>exchange<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>routingKey<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">await</span> channel<span class=\"token punctuation\">.</span><span class=\"token function\">prefetch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>prefetchCount<span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>isGlobalPrefetchCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchannel<span class=\"token punctuation\">.</span><span class=\"token function\">consume</span><span class=\"token punctuation\">(</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>queue<span class=\"token punctuation\">,</span></code></pre></div>\n<h2 id=\"결과\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC\" aria-label=\"결과 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>결과</h2>\n<p>그 결과로 실제 local에서 RabbitMQ와 nestjs microservice 설정을 진행해보았는데, 제기되었던 이슈의 문제를 말끔하게 해결할 수 있게 되었습니다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/fc2fcd382816d4102877cccd1926a734/64756/image-1.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 128.23529411764707%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAABYlAAAWJQFJUiTwAAAELklEQVR42p1T+U9jVRSuJmocRZkZoKXre6/L6+sCpaUdisA4LENG/wp/MPHvMDFu45hJjDEx8RcjmEwcGRB0oIATl99AtmDYBmQr0FIaCFDWz3NugRkyBQ23+XLuu/ec73znnFtdYbEFiqpBdqqQHCpMVgkWSYFVtsNokWC22WGxKTAfnTMMJgsMRgvyC4rxSr4er15+Ap3JYkOgrBRV9Y14s74Wt95+C/U36xGtqUb0eiXqGqsQrboGFyV0qyq8Hg8cdjvsioICvYkIi04TGk1WSDYrPNeqEQgH0HirEdFoCO5gOSI1IVTXlSFU4YO3xA2JSCwkQJIkKIqMq3pjDkKzVWT0aiUIeEMo8QXhCUQRCpfD43HC4XTDRS1xuTWoLhc0ldXZIZ9HyPJVp4aa6huIVFYhUhFBXe11hCMROFU/NG+QCEsR8PsQDqhwErEsK+cQ2hUohIo3KlEWLIXPI8NfosLjc8PtdooSJckGm80Gq1U6v2Qeiqq6YDabSVlUkGpeN5WqkBIZdgf3zSLun4aFcKUw15S5hw6HyFoWDOFGQwNCZSFo9IQstuwAZFl+BucPxUFNpsBQeRiRUDn8mlu0IBfRfxKeKCQ14UgYtQ03URr0w+MnUkW5GKGdH6rDRQNwiQmyYofTfnFCB5Wnev0oCUXgKw1CcwegyBcsmf+jqssJzReAPxCGR3OSsz2r+hxwFYXFZuRdMeC1q8UCgrCgUA+j0QijyQSDwQC93oAigx5F+tzgez1Z9n057zKeezEPz7+Uhxcu5WcJ3//gI8RiMTQ1NaO942d0dnWhK9aN7p7eU+hh291D9zFxHyO/zocP0dHxC3p/fYTbd+7i0uuF0P3Y2o6dzDZGR0exuLiImZkZpNNp7O3tYWtrCzs7O8hkMtje3ia/DBYWFugsg3h6HXPpDSTW0+SfQk/voyzhvR9agMNDxJeWsLKygpGREfT392N4eARDQ0PCDgwMoK+vD0PDw5ienkacEg8urOC3mWX8NfcPUmsJNH9/L1vy/ZY28IrH41hdXcXy8jI2Nzfxf9f+/r6wse5e0U/dV19/g4nJKfz+x5+kZJBK/xuT9D1xhMmpx1nQfkrspwQmBB5jfGISc3Pz6KS+hqM10H37XbNQNzg4JBwTiSSVnhA2mVzFEileplaw8kXy47bweSKZPAG365B+LQ/aoHvQ1n4i/ZB6ySuVSmF+fp5IExgfGyN1k5idnRVnPDAe1O7u7jNlM5eupfUn8cFTPTg4EPv19fVs80kRkyRJBfeXicYoQVNTE8bHx4Uvx3AsL+Y6pfDpjKyALQew8uMKmHRjY0PYnArvt7SKD35rnOkJ9oVl4tTamih/h/Z7R0nYHvtyLC/myqnw1LOggOPHfVzaWU9HKHzn3fdw94sv8eEnn+Hj25+fjU/vnHnHsczBXP8CwCXT2QQvaVwAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='실제 테스트 결과' title='' src='/static/fc2fcd382816d4102877cccd1926a734/ca1dc/image-1.png' srcset='/static/fc2fcd382816d4102877cccd1926a734/e7570/image-1.png 170w,\n/static/fc2fcd382816d4102877cccd1926a734/f46e7/image-1.png 340w,\n/static/fc2fcd382816d4102877cccd1926a734/ca1dc/image-1.png 680w,\n/static/fc2fcd382816d4102877cccd1926a734/02d09/image-1.png 1020w,\n/static/fc2fcd382816d4102877cccd1926a734/64756/image-1.png 1200w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>실제 테스트 결과</figcaption>\n  </figure></p>\n<p>queue를 ''으로 설정했을 때, Name이 'default'가 아닌 'amq.gen-...'으로 지정되었고, Binding의 option 또한 내가 지정한대로 잘 적용된 것을 확인할 수 있습니다.</p>\n<p>아직, merge되진 않았지만 다른 분께서 좋은 제안인 것 같다는 코멘트와 메인테이너 분께서 해당 이슈를 completed로 변경하신 뒤 milestone을 적용해주신 것으로 보아, 다음 milestone까지 해당 PR에서 추가 피드백이나 논의가 진행될 것으로 예상됩니다.</p>\n<ul>\n<li>2024.11.20 기준으로 드디어 nestjs 11 milestone에 PR이 merge 되었습니다~~~!</li>\n</ul>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/18004b8262f85ce36cb0194ffc63277f/650fc/image-2.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 44.705882352941174%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAABnElEQVR42mVSyXajMBD0Nd7YkYQAIQIIHDuJne1l5pBT7vmh+faabmFneTnUE2qpS1XVLNaRQJiVaLoJuhkgq2u/ZwRpQav2WIc5rrbpLyyDDCs+CxIswxQLJtzEEvePf/D4+obd3ROG/QnDzRHj4YTp9gkT1Rx9W7dHM+zRugO66c6vhemQSouPv/9wmj6+CBUp09YhKxqkyiCWDRJlkUkDpQ1EYSFpL9R8Pt9rEAlDDiqoYkKS2ZkwIEuH47NXxbYTWSMQPbZyhBY1hrJETSq60qEn5PRILCqEskOgdvRwi3Wckf2zZc6qJKJcW0/mc6Ma16O8pOaalFTY0n5F9zkzxjrKfbYeVGd4wpCaJsqIM6na8dM2Q5TtPKy6IyWGlMjP5ktcm2+1OcNEoh33MN3ON3M23OyVnRWGOYHySnWLjM4vBDzlC1j1YhkmaKoXPD+80ySPsMNhtk6EBZFzFKHqkWiHtOBIzA9F2o4o24mmzZG1WGwSQRPaoXcPqK6d/w/jvPKhX2xHoqGpW6+U68E5X4YyPT3sfCQc1X+UEeun2HM6KgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='메인테이너가 직접 merge를 해주셨습니다~!' title='' src='/static/18004b8262f85ce36cb0194ffc63277f/ca1dc/image-2.png' srcset='/static/18004b8262f85ce36cb0194ffc63277f/e7570/image-2.png 170w,\n/static/18004b8262f85ce36cb0194ffc63277f/f46e7/image-2.png 340w,\n/static/18004b8262f85ce36cb0194ffc63277f/ca1dc/image-2.png 680w,\n/static/18004b8262f85ce36cb0194ffc63277f/02d09/image-2.png 1020w,\n/static/18004b8262f85ce36cb0194ffc63277f/9d567/image-2.png 1360w,\n/static/18004b8262f85ce36cb0194ffc63277f/650fc/image-2.png 1690w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>메인테이너가 직접 merge를 해주셨습니다~!</figcaption>\n  </figure></p>","frontmatter":{"title":"[NestJS] @nestjs/microservices should handle RabbitMQ bindings and auto-generated queues","date":"November 16, 2024","update":"November 16, 2024","tags":["오픈소스","NestJS"],"series":"Open Source"},"fields":{"slug":"/oss_project_03/","readingTime":{"minutes":3.865}}},"seriesList":{"edges":[{"node":{"id":"3accd50a-09fd-588c-936a-7809cd4efe98","fields":{"slug":"/opensource-toss-aop/"},"frontmatter":{"title":"Toss AOP 라이브러리 한글 문서 번역 기여"}}},{"node":{"id":"243c95d7-52e9-511c-bc84-153b14dd56b2","fields":{"slug":"/oss_project_03/"},"frontmatter":{"title":"[NestJS] @nestjs/microservices should handle RabbitMQ bindings and auto-generated queues"}}},{"node":{"id":"1d292280-c3ec-5489-863f-79b9076e8166","fields":{"slug":"/oss_project_02/"},"frontmatter":{"title":"[NestJS] type narrowing context parameter on createParamDecorator's callback"}}},{"node":{"id":"d05349f8-3eda-5625-b12b-0906620cf291","fields":{"slug":"/oss_project_01/"},"frontmatter":{"title":"오픈 소스 기여: 작은 코드의 큰 가치"}}}]},"previous":{"fields":{"slug":"/nodejs_study_01/"},"frontmatter":{"title":"왜 NodeJS는 싱글 스레드인거지?"}},"next":{"fields":{"slug":"/oss_project_02/"},"frontmatter":{"title":"[NestJS] type narrowing context parameter on createParamDecorator's callback"}}},"pageContext":{"id":"243c95d7-52e9-511c-bc84-153b14dd56b2","series":"Open Source","previousPostId":"9b56493d-8b9c-5305-871e-9ede5a0d8b4c","nextPostId":"1d292280-c3ec-5489-863f-79b9076e8166"}},"staticQueryHashes":[],"slicesMap":{}}