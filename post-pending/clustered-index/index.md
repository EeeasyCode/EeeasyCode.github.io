---
title: "동시성 이슈 해결해보기"
description: "동시에 같은 DB Table row 를 업데이트 하는 상황에는 어떻게 해결해야 할까?"
date: 2025-05-14
update: 2025-05-14
tags:
  - database
series: "database"
---

# Clustered Index vs Non-Clustered Index

데이터베이스에서 성능 최적화와 효율적인 데이터 검색은 매우 중요한 과제입니다. 이와 관련하여 인덱스는 데이터베이스의 핵심 요소 중 하나로, 데이터 정렬과 검색 속도를 크게 향상시킵니다. MySQL(InnoDB) 기준으로 Clustered Index와 Non-Clustered Index의 차이점과 사용 목적을 자세히 정리해보겠습니다.

## Clustered Index란?

Clustered Index는 테이블의 데이터 전체가 인덱스와 함께 물리적으로 정렬되는 방식의 인덱스입니다. 즉, 데이터 자체가 인덱스의 일부로 동작하기 때문에 데이터 검색에서 매우 효율적입니다. Clustered Index는 다음과 같은 특징을 가지고 있습니다:

1. **테이블 당 하나만 생성 가능**: 물리적으로 데이터를 정렬해야 하므로 한 테이블에 여러 개의 Clustered Index를 생성할 수 없습니다.
2. **기본 키(PK)와 연관**: 기본적으로 테이블의 기본 키(PK)가 Clustered Index로 설정됩니다. 만약 기본 키가 없을 경우, `unique`와 `NOT NULL` 조건을 만족하는 열이 사용됩니다. 이러한 조건이 없는 경우, MySQL은 내부적으로 `row_id`를 생성하여 Clustered Index를 설정합니다.
3. **빠른 데이터 검색**: 데이터가 물리적으로 정렬되어 있으므로, 범위 검색(range query)이나 순차 검색(sequential scan)에서 매우 효율적입니다.

### Clustered Index의 장점

- 데이터와 인덱스가 동일한 구조를 가지므로 검색 속도가 빠릅니다.
- 범위 검색이 자주 필요한 경우 특히 유리합니다.

### Clustered Index의 단점

- 데이터 삽입/삭제 시 물리적 정렬이 필요하므로 성능 저하가 발생할 수 있습니다.
- 테이블 당 하나만 생성 가능하므로, 인덱스 설계에 제약이 따릅니다.

## Non-Clustered Index란?

Non-Clustered Index는 Clustered Index와 달리, 데이터 자체와는 별도로 생성되는 보조 인덱스입니다. Non-Clustered Index는 데이터가 물리적으로 정렬되지 않으며, 대신 정렬된 별도의 인덱스 페이지를 생성하여 관리합니다. 이로 인해 Non-Clustered Index는 다음과 같은 특징을 가집니다:

1. **테이블 당 여러 개 생성 가능**: Clustered Index와 달리, Non-Clustered Index는 한 테이블에서 여러 개를 생성할 수 있습니다.
2. **보조 인덱스**: Non-Clustered Index는 데이터의 실제 저장 위치를 참조(pointer)하며, 데이터 자체를 포함하지 않습니다.
3. **데이터 정렬 없음**: 물리적으로 데이터를 정렬하지 않으므로 삽입/삭제 작업에서 성능 저하가 적습니다.

### Non-Clustered Index의 장점

- 하나의 테이블에 여러 개의 인덱스를 생성할 수 있어 다양한 검색 조건에서 유연하게 사용할 수 있습니다.
- 삽입/삭제 작업에서 성능 저하가 적습니다.

### Non-Clustered Index의 단점

- 데이터 검색 시, 인덱스에서 데이터를 다시 참조해야 하므로 Clustered Index에 비해 검색 성능이 느릴 수 있습니다.
- 추가적인 저장 공간이 필요합니다.

## Clustered Index와 Non-Clustered Index의 비교

| 특징             | Clustered Index                        | Non-Clustered Index                      |
| ---------------- | -------------------------------------- | ---------------------------------------- |
| 데이터 정렬 여부 | 물리적으로 데이터 정렬                 | 데이터 정렬 없음                         |
| 생성 가능 개수   | 테이블 당 하나                         | 테이블 당 여러 개                        |
| 저장 공간        | 추가 공간 불필요                       | 추가 저장 공간 필요                      |
| 검색 성능        | 데이터와 인덱스가 동일하여 빠름        | 인덱스에서 데이터 참조로 인해 다소 느림  |
| 삽입/삭제 성능   | 물리적 정렬 필요로 인해 성능 저하 가능 | 물리적 정렬 없음으로 인해 성능 저하 적음 |

## 결론

Clustered Index와 Non-Clustered Index는 각각의 장단점과 목적에 따라 사용됩니다. Clustered Index는 데이터가 자주 정렬되거나 범위 검색이 필요한 경우 유리하며, Non-Clustered Index는 다양한 검색 조건에 대응하기 위해 보조 인덱스로 활용됩니다. 데이터베이스 인덱스를 설계할 때, 테이블 구조와 쿼리 패턴을 고려하여 적절히 선택하는 것이 중요합니다.

데이터베이스 성능을 최적화하기 위해 두 인덱스의 차이점을 명확히 이해하고, 적절한 전략을 수립하는 것이 필요합니다. 이를 통해 효율적인 데이터 관리와 검색 성능 향상을 도모할 수 있습니다.
